{
  "_properties": { "isServerWorkflow": false },
  "components": [
    {
      "id": 2,
      "steps": [
        {
          "id": 3,
          "inputs": {},
          "position": "-150,-110",
          "purpose": "start",
          "title": "Start",
          "transitions": [
            {
              "id": 752,
              "inputs": {},
              "position": "-60,-50 -60,0",
              "sourceConnector": "bottom",
              "target": { "id": 679 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Container",
          "description": "Initialize variables",
          "id": 679,
          "inputs": {},
          "position": "-180,0",
          "title": "Setup",
          "transitions": [
            {
              "id": 733,
              "inputs": {},
              "position": "-60,120 -60,180",
              "target": { "id": 683 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::Subworkflow",
          "id": 681,
          "inputs": {
            "subworkflow": {
              "accessors": ["$$subworkflow"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$$subworkflow",
              "source": "$$subworkflow"
            }
          },
          "name": "generateQueryFields",
          "position": "160,390",
          "title": "Query Fields"
        },
        {
          "action": "gcx:wf:core::Container",
          "description": "Get the target layer",
          "id": 683,
          "inputs": {},
          "position": "-180,180",
          "title": "Find Layer",
          "transitions": [
            {
              "id": 735,
              "inputs": {},
              "position": "-60,300 -60,390",
              "sourceConnector": "bottom",
              "target": { "id": 685 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms:form:DisplayForm",
          "id": 685,
          "inputs": {
            "form": {
              "accessors": [],
              "code": "resources.forms[values.id]",
              "values": { "id": 677 }
            },
            "reset": false
          },
          "name": "queryForm",
          "position": "-180,390",
          "title": "Display Form",
          "transitions": [
            {
              "id": 751,
              "inputs": {},
              "position": "-60,510 -60,570",
              "sourceConnector": "bottom",
              "target": { "id": 701 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Exit",
          "id": 687,
          "inputs": {},
          "position": "200,1190",
          "title": "Exit"
        },
        {
          "action": "gcx:wf:core::Subworkflow",
          "id": 689,
          "inputs": {
            "subworkflow": {
              "accessors": ["$$subworkflow"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$$subworkflow",
              "source": "$$subworkflow"
            }
          },
          "name": "changedEvent",
          "position": "450,390",
          "title": "Changed"
        },
        {
          "action": "gcx:wf:core::SetWorkflowOutput",
          "id": 691,
          "inputs": {
            "name": "action",
            "value": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm.result",
              "source": "$queryForm.result"
            }
          },
          "position": "-460,640",
          "title": "Set Workflow Output",
          "transitions": [
            {
              "id": 737,
              "inputs": {},
              "position": "-340,670 -340,830",
              "target": { "id": 693 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Exit",
          "id": 693,
          "inputs": {},
          "position": "-430,830",
          "title": "Exit"
        },
        {
          "action": "gcx:wf:core::SetWorkflowOutput",
          "id": 695,
          "inputs": {
            "name": "action",
            "value": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm.result",
              "source": "$queryForm.result"
            }
          },
          "position": "170,1110",
          "title": "Set Workflow Output",
          "transitions": [
            {
              "id": 760,
              "inputs": {},
              "position": "290,1140 290,1190",
              "target": { "id": 687 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Subworkflow",
          "id": 697,
          "inputs": {
            "subworkflow": {
              "accessors": ["$$subworkflow"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$$subworkflow",
              "source": "$$subworkflow"
            }
          },
          "name": "clickedEvent",
          "position": "150,180",
          "title": "Clicked"
        },
        {
          "action": "gcx:wf:core::Subworkflow",
          "id": 699,
          "inputs": {
            "subworkflow": {
              "accessors": ["$$subworkflow"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$$subworkflow",
              "source": "$$subworkflow"
            }
          },
          "name": "validateEvent",
          "position": "450,180",
          "title": "Validate"
        },
        {
          "action": "gcx:wf:core::If",
          "id": 701,
          "inputs": {
            "condition": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm.result == \"cancel\"",
              "source": "$queryForm.result == \"cancel\""
            }
          },
          "position": "-120,570",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 741,
              "inputs": {},
              "position": "-120,600 -340,600 -340,640",
              "target": { "id": 691 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 743,
              "inputs": {},
              "position": "0,600 80,600 80,970",
              "sourceConnector": "right",
              "target": { "id": 703 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 703,
          "inputs": {
            "condition": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm.result != \"back\"",
              "source": "$queryForm.result != \"back\""
            }
          },
          "position": "20,970",
          "title": "If",
          "transitions": [
            {
              "branch": "false",
              "id": 745,
              "inputs": {},
              "position": "140,1000 290,1000 290,1110",
              "sourceConnector": "right",
              "target": { "id": 695 },
              "targetConnector": "top"
            },
            {
              "branch": "true",
              "id": 747,
              "inputs": {},
              "position": "20,1000 -220,995",
              "target": { "id": 705 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Container",
          "id": 705,
          "inputs": {},
          "position": "-460,950",
          "title": "Run Query",
          "transitions": [
            {
              "id": 749,
              "inputs": {},
              "position": "-460,995 -480,995 -480,450 -180,450",
              "sourceConnector": "left",
              "target": { "id": 685 },
              "targetConnector": "left"
            }
          ]
        },
        {
          "action": "gcx:wf:core::Subworkflow",
          "id": 707,
          "inputs": {
            "subworkflow": {
              "accessors": ["$$subworkflow"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$$subworkflow",
              "source": "$$subworkflow"
            }
          },
          "name": "populateEvent",
          "position": "150,0",
          "title": "Populate"
        },
        {
          "action": "gcx:wf:core::Subworkflow",
          "id": 709,
          "inputs": {
            "subworkflow": {
              "accessors": ["$$subworkflow"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$$subworkflow",
              "source": "$$subworkflow"
            }
          },
          "name": "suggestEvent",
          "position": "450,0",
          "title": "Suggest"
        }
      ]
    },
    {
      "id": 258,
      "steps": [
        {
          "action": "gcx:wf:core:subworkflow:RunSubworkflow",
          "id": 260,
          "inputs": {
            "arguments": {
              "accessors": ["$suggestSearchField"],
              "annotations": [{ "count": 19, "index": 8, "kind": "idref" }],
              "code": "{ field: $suggestSearchField.result.field }",
              "source": "{field: $suggestSearchField.result.field}"
            },
            "subworkflowId": {
              "accessors": ["activities"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "activities.generateQueryFields",
              "source": "activities.generateQueryFields"
            }
          },
          "name": "suggestFields",
          "position": "-40,670",
          "title": "Run Subworkflow",
          "transitions": [
            {
              "id": 292,
              "inputs": {},
              "position": "80,740 80,790",
              "target": { "id": 262 }
            }
          ]
        },
        {
          "action": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3::GetLayerCodedValues",
          "id": 262,
          "inputs": {
            "field": {
              "accessors": ["$suggestSearchField"],
              "annotations": [{ "count": 19, "index": 0, "kind": "idref" }],
              "code": "$suggestSearchField.result.field",
              "source": "$suggestSearchField.result.field"
            },
            "layer": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result",
              "source": "$layer.result"
            }
          },
          "name": "suggestCodedValues",
          "position": "-40,790",
          "title": "Get Layer Coded Values",
          "transitions": [
            {
              "id": 294,
              "inputs": {},
              "position": "80,860 80,1100",
              "sourceConnector": "bottom",
              "target": { "id": 264 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 264,
          "inputs": {
            "condition": {
              "accessors": ["$suggestCodedValues", "$suggestCodedValues"],
              "annotations": [
                { "count": 19, "index": 2, "kind": "idref" },
                { "count": 19, "index": 31, "kind": "idref" }
              ],
              "code": "!!$suggestCodedValues.result && $suggestCodedValues.result.length > 0",
              "source": "!!$suggestCodedValues.result &&$suggestCodedValues.result.length > 0"
            }
          },
          "position": "20,1100",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 298,
              "inputs": {},
              "position": "20,1130 -100,1130 -100,1230",
              "sourceConnector": "left",
              "target": { "id": 270 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 300,
              "inputs": {},
              "position": "140,1130 240,1130 240,1520",
              "sourceConnector": "right",
              "target": { "id": 272 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3::GenerateWhereClause",
          "id": 266,
          "inputs": {
            "layer": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result",
              "source": "$layer.result"
            },
            "queryFields": {
              "accessors": ["$searchFields"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$searchFields.result",
              "source": "$searchFields.result"
            },
            "targetForm": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm",
              "source": "$queryForm"
            }
          },
          "name": "suggestWhereClause",
          "position": "-40,360",
          "title": "Generate Where Clause",
          "transitions": [
            {
              "id": 296,
              "inputs": {},
              "position": "80,430 80,490",
              "sourceConnector": "bottom",
              "target": { "id": 268 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::TextReplace",
          "description": "Escape apostrophe characters to avoid SQL injection and broken queries.",
          "id": 268,
          "inputs": {
            "newValue": "''",
            "oldValue": "'",
            "text": {
              "accessors": ["$suggestEventData"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$suggestEventData.argument",
              "source": "$suggestEventData.argument"
            }
          },
          "name": "textReplace1",
          "position": "-40,490",
          "title": "Text Replace",
          "transitions": [
            {
              "id": 306,
              "inputs": {},
              "position": "80,620 80,670",
              "target": { "id": 260 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 270,
          "inputs": {
            "expression": {
              "accessors": ["$suggestCodedValues", "$textReplace1"],
              "annotations": [
                { "count": 19, "index": 15, "kind": "idref" },
                { "count": 13, "index": 97, "kind": "idref" }
              ],
              "code": "(function () {\n    return $suggestCodedValues.result.filter(function (x) {\n        return x.name.toUpperCase().includes($textReplace1.result.toUpperCase());\n    });\n})()",
              "source": "(()=> {\nreturn $suggestCodedValues.result.filter((x)=> { \n  return x.name.toUpperCase().includes($textReplace1.result.toUpperCase()\n)})\n\n })()"
            }
          },
          "name": "filteredSuggestCodes",
          "position": "-220,1230",
          "title": "Create Value",
          "transitions": [
            {
              "id": 302,
              "inputs": {},
              "position": "-100,1300 -100,1380",
              "target": { "id": 274 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 272,
          "inputs": {
            "expression": {
              "accessors": [
                "$suggestWhereClause",
                "$suggestWhereClause",
                "$suggestWhereClause",
                "$suggestWhereClause",
                "$suggestSearchField",
                "$textReplace1",
                "$suggestSearchField",
                "$textReplace1"
              ],
              "annotations": [
                { "count": 19, "index": 0, "kind": "idref" },
                { "count": 19, "index": 31, "kind": "idref" },
                { "count": 19, "index": 61, "kind": "idref" },
                { "count": 19, "index": 104, "kind": "idref" },
                { "count": 19, "index": 144, "kind": "idref" },
                { "count": 13, "index": 193, "kind": "idref" },
                { "count": 19, "index": 230, "kind": "idref" },
                { "count": 13, "index": 279, "kind": "idref" }
              ],
              "code": "$suggestWhereClause.result = !!$suggestWhereClause.result && $suggestWhereClause.result.length > 0 ? \"\".concat($suggestWhereClause.result, \" AND UPPER(\").concat($suggestSearchField.result.field, \") LIKE UPPER('\").concat($textReplace1.result, \"%')\") : \"UPPER(\".concat($suggestSearchField.result.field, \") LIKE UPPER('\").concat($textReplace1.result, \"%')\")",
              "source": "$suggestWhereClause.result = !!$suggestWhereClause.result && $suggestWhereClause.result.length > 0 ? `${$suggestWhereClause.result} AND UPPER(${$suggestSearchField.result.field}) LIKE UPPER('${$textReplace1.result}%')` : `UPPER(${$suggestSearchField.result.field}) LIKE UPPER('${$textReplace1.result}%')`"
            }
          },
          "name": "updatedSuggestWhereClause",
          "position": "120,1520",
          "title": "Evaluate Expression",
          "transitions": [
            {
              "id": 304,
              "inputs": {},
              "position": "240,1590 240,1650",
              "sourceConnector": "bottom",
              "target": { "id": 276 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 274,
          "inputs": {
            "condition": {
              "accessors": ["$filteredSuggestCodes"],
              "annotations": [{ "count": 21, "index": 0, "kind": "idref" }],
              "code": "$filteredSuggestCodes.result.length > 0",
              "source": "$filteredSuggestCodes.result.length > 0"
            }
          },
          "position": "-160,1380",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 308,
              "inputs": {},
              "position": "-160,1410 -250,1410 -250,1520",
              "sourceConnector": "left",
              "target": { "id": 278 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:arcgis:query:QueryTask",
          "description": "Query for features.",
          "id": 276,
          "inputs": {
            "outFields": {
              "accessors": ["$suggestSearchField"],
              "annotations": [{ "count": 19, "index": 0, "kind": "idref" }],
              "code": "$suggestSearchField.result.field",
              "source": "$suggestSearchField.result.field"
            },
            "returnDistinctValues": true,
            "returnGeometry": false,
            "url": {
              "accessors": ["$layerUrl"],
              "annotations": [{ "count": 9, "index": 0, "kind": "idref" }],
              "code": "$layerUrl.result",
              "source": "$layerUrl.result"
            },
            "where": {
              "accessors": ["$suggestWhereClause"],
              "annotations": [{ "count": 19, "index": 0, "kind": "idref" }],
              "code": "$suggestWhereClause.result",
              "source": "$suggestWhereClause.result"
            }
          },
          "name": "suggestFeatureQuery",
          "position": "120,1650",
          "title": "Query Layer",
          "transitions": [
            {
              "id": 310,
              "inputs": {},
              "position": "240,1750 240,1790",
              "target": { "id": 280 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormElementItemsFromCollection",
          "id": 278,
          "inputs": {
            "collection": {
              "accessors": ["$filteredSuggestCodes"],
              "annotations": [{ "count": 21, "index": 0, "kind": "idref" }],
              "code": "$filteredSuggestCodes.result",
              "source": "$filteredSuggestCodes.result"
            },
            "labelFieldName": "name",
            "valueFieldName": "code"
          },
          "name": "suggestCodedFormItems",
          "position": "-370,1520",
          "title": "Get Form Element Items From Collection",
          "transitions": [
            {
              "id": 312,
              "inputs": {},
              "position": "-250,1590 -250,1670",
              "target": { "id": 282 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormElementItemsFromFeatures",
          "description": "Convert the features into form element items to be used in the element.",
          "id": 280,
          "inputs": {
            "features": {
              "accessors": ["$suggestFeatureQuery"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$suggestFeatureQuery.features",
              "source": "$suggestFeatureQuery.features"
            },
            "labelFieldName": {
              "accessors": ["$suggestSearchField"],
              "annotations": [{ "count": 19, "index": 0, "kind": "idref" }],
              "code": "$suggestSearchField.result.field",
              "source": "$suggestSearchField.result.field"
            },
            "valueFieldName": {
              "accessors": ["$suggestSearchField"],
              "annotations": [{ "count": 19, "index": 0, "kind": "idref" }],
              "code": "$suggestSearchField.result.field",
              "source": "$suggestSearchField.result.field"
            }
          },
          "name": "suggestFeatureFormItems",
          "position": "120,1790",
          "title": "Get Form Element Items From Features",
          "transitions": [
            {
              "id": 314,
              "inputs": {},
              "position": "240,1920 240,1990",
              "target": { "id": 284 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::SetFormElementItems",
          "description": "",
          "id": 282,
          "inputs": {
            "elementName": {
              "accessors": ["$suggestEventData"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$suggestEventData.elementId",
              "source": "$suggestEventData.elementId"
            },
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            },
            "items": {
              "accessors": ["$suggestCodedFormItems"],
              "annotations": [{ "count": 22, "index": 0, "kind": "idref" }],
              "code": "$suggestCodedFormItems.items",
              "source": "$suggestCodedFormItems.items"
            }
          },
          "position": "-370,1670",
          "title": "Set Form Element Items"
        },
        {
          "action": "gcx:wf:forms::SetFormElementItems",
          "description": "",
          "id": 284,
          "inputs": {
            "elementName": {
              "accessors": ["$suggestEventData"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$suggestEventData.elementId",
              "source": "$suggestEventData.elementId"
            },
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            },
            "items": {
              "accessors": ["$suggestFeatureFormItems"],
              "annotations": [{ "count": 24, "index": 0, "kind": "idref" }],
              "code": "$suggestFeatureFormItems.items",
              "source": "$suggestFeatureFormItems.items"
            }
          },
          "position": "120,1990",
          "title": "Set Form Element Items"
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 286,
          "inputs": {
            "expression": {
              "accessors": ["$searchFields", "$suggestEventData"],
              "annotations": [
                { "count": 13, "index": 0, "kind": "idref" },
                { "count": 17, "index": 41, "kind": "idref" }
              ],
              "code": "$searchFields.result.find(function (x) { return x.field === $suggestEventData.elementId; })",
              "source": "$searchFields.result.find(x=> x.field ===$suggestEventData.elementId)"
            }
          },
          "name": "suggestSearchField",
          "position": "-40,240",
          "title": "Evaluate Expression",
          "transitions": [
            {
              "id": 316,
              "inputs": {},
              "position": "80,310 80,360",
              "sourceConnector": "bottom",
              "target": { "id": 266 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormEventData",
          "id": 288,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "name": "suggestEventData",
          "position": "-40,120",
          "title": "Get Form Event Data",
          "transitions": [
            {
              "id": 318,
              "inputs": {},
              "position": "80,190 80,240",
              "target": { "id": 286 }
            }
          ]
        },
        {
          "id": 290,
          "inputs": {},
          "position": "-10,0",
          "purpose": "start",
          "title": "Subworkflow",
          "transitions": [
            {
              "id": 320,
              "inputs": {},
              "position": "80,60 80,120",
              "target": { "id": 288 }
            }
          ]
        }
      ]
    },
    {
      "id": 322,
      "steps": [
        {
          "action": "gcx:wf:core:subworkflow:RunSubworkflow",
          "id": 324,
          "inputs": {
            "arguments": {
              "accessors": ["$populateSearchField"],
              "annotations": [{ "count": 20, "index": 8, "kind": "idref" }],
              "code": "{ field: $populateSearchField.result.field }",
              "source": "{field: $populateSearchField.result.field}"
            },
            "subworkflowId": {
              "accessors": ["activities"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "activities.generateQueryFields",
              "source": "activities.generateQueryFields"
            }
          },
          "name": "populateFields",
          "position": "-20,450",
          "title": "Run Subworkflow",
          "transitions": [
            {
              "id": 359,
              "inputs": {},
              "position": "100,520 100,580",
              "target": { "id": 326 }
            }
          ]
        },
        {
          "action": "gcx:wf:arcgis:query:QueryTask",
          "description": "Query for features.",
          "id": 326,
          "inputs": {
            "outFields": {
              "accessors": ["$populateFields"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$populateFields.result.fields",
              "source": "$populateFields.result.fields"
            },
            "returnDistinctValues": true,
            "returnGeometry": false,
            "url": {
              "accessors": ["$layerUrl"],
              "annotations": [{ "count": 9, "index": 0, "kind": "idref" }],
              "code": "$layerUrl.result",
              "source": "$layerUrl.result"
            },
            "where": {
              "accessors": [
                "$populateWhereClause",
                "$populateWhereClause",
                "$populateWhereClause"
              ],
              "annotations": [
                { "count": 20, "index": 2, "kind": "idref" },
                { "count": 20, "index": 33, "kind": "idref" },
                { "count": 20, "index": 74, "kind": "idref" }
              ],
              "code": "!!$populateWhereClause.result && $populateWhereClause.result.length > 0 ? $populateWhereClause.result : \"1=1\"",
              "source": "!!$populateWhereClause.result && $populateWhereClause.result.length > 0 ? $populateWhereClause.result: `1=1`"
            }
          },
          "name": "populateQuery",
          "position": "-20,580",
          "title": "Query Layer",
          "transitions": [
            {
              "id": 373,
              "inputs": {},
              "position": "100,680 100,730",
              "sourceConnector": "bottom",
              "target": { "id": 335 }
            }
          ]
        },
        {
          "action": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3::GetLayerCodedValues",
          "id": 328,
          "inputs": {
            "field": {
              "accessors": ["$populateSearchField"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$populateSearchField.result.field",
              "source": "$populateSearchField.result.field"
            },
            "layer": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result",
              "source": "$layer.result"
            },
            "subTypeCode": {
              "accessors": ["$layer", "$populateQuery", "$layer"],
              "annotations": [
                { "count": 6, "index": 0, "kind": "idref" },
                { "count": 14, "index": 29, "kind": "idref" },
                { "count": 6, "index": 63, "kind": "idref" }
              ],
              "code": "$layer.result.subtypeField ? $populateQuery.feature.attributes[$layer.result.subtypeField] : undefined",
              "source": "$layer.result.subtypeField ? $populateQuery.feature.attributes[$layer.result.subtypeField] : undefined"
            }
          },
          "name": "populateCodedValues",
          "position": "-20,880",
          "title": "Get Layer Coded Values",
          "transitions": [
            {
              "id": 361,
              "inputs": {},
              "position": "100,950 100,1040",
              "sourceConnector": "bottom",
              "target": { "id": 331 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 331,
          "inputs": {
            "condition": {
              "accessors": ["$populateCodedValues", "$populateCodedValues"],
              "annotations": [
                { "count": 20, "index": 2, "kind": "idref" },
                { "count": 20, "index": 33, "kind": "idref" }
              ],
              "code": "!!$populateCodedValues.result && $populateCodedValues.result.length > 0",
              "source": "!!$populateCodedValues.result && $populateCodedValues.result.length > 0"
            }
          },
          "position": "40,1040",
          "title": "If",
          "transitions": [
            {
              "branch": "false",
              "id": 367,
              "inputs": {},
              "position": "160,1070 360,1070 360,1170",
              "sourceConnector": "right",
              "target": { "id": 337 },
              "targetConnector": "top"
            },
            {
              "branch": "true",
              "id": 369,
              "inputs": {},
              "position": "40,1070 -170,1070 -170,1170",
              "sourceConnector": "left",
              "target": { "id": 339 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3::GenerateWhereClause",
          "id": 333,
          "inputs": {
            "layer": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result",
              "source": "$layer.result"
            },
            "queryFields": {
              "accessors": ["$searchFields"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$searchFields.result.searchFields",
              "source": "$searchFields.result.searchFields"
            },
            "targetForm": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm",
              "source": "$queryForm"
            }
          },
          "name": "populateWhereClause",
          "position": "-20,330",
          "title": "Generate Where Clause",
          "transitions": [
            {
              "id": 363,
              "inputs": {},
              "position": "100,400 100,450",
              "target": { "id": 324 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 335,
          "inputs": {
            "condition": {
              "accessors": ["$populateQuery"],
              "annotations": [{ "count": 14, "index": 0, "kind": "idref" }],
              "code": "$populateQuery.features.length > 0",
              "source": "$populateQuery.features.length > 0"
            }
          },
          "position": "40,730",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 365,
              "inputs": {},
              "position": "40,760 20,760 20,860 100,860 100,880",
              "sourceConnector": "left",
              "target": { "id": 328 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:arcgis::SortFeatureSet",
          "id": 337,
          "inputs": {
            "features": {
              "accessors": ["$populateQuery"],
              "annotations": [{ "count": 14, "index": 0, "kind": "idref" }],
              "code": "$populateQuery.features",
              "source": "$populateQuery.features"
            },
            "sortAttribute": {
              "accessors": ["$populateSearchField"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$populateSearchField.result.field",
              "source": "$populateSearchField.result.field"
            }
          },
          "name": "sortedPopulateFeatures",
          "position": "240,1170",
          "title": "Sort Feature Set",
          "transitions": [
            {
              "id": 371,
              "inputs": {},
              "position": "360,1240 360,1290",
              "sourceConnector": "bottom",
              "target": { "id": 341 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 339,
          "inputs": {
            "expression": {
              "accessors": ["$populateCodedValues"],
              "annotations": [{ "count": 20, "index": 139, "kind": "idref" }],
              "code": "(function () {\n    function compare(a, b) {\n        if (a.name < b.name) {\n            return -1;\n        }\n        if (a.name > b.name) {\n            return 1;\n        }\n        return 0;\n    }\n    $populateCodedValues.result.sort(compare);\n})()",
              "source": "(()=>{\nfunction compare( a, b ) {\n  if ( a.name < b.name ){\n    return -1;\n  }\n  if ( a.name > b.name  ){\n    return 1;\n  }\n  return 0;\n}\n\n$populateCodedValues.result.sort( compare );\n})()"
            }
          },
          "name": "sortedPopulateCodes",
          "position": "-290,1170",
          "title": "Evaluate Expression",
          "transitions": [
            {
              "id": 389,
              "inputs": {},
              "position": "-170,1240 -170,1300",
              "sourceConnector": "bottom",
              "target": { "id": 355 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormElementItemsFromFeatures",
          "description": "Convert the features into form element items to be used in the element.",
          "id": 341,
          "inputs": {
            "features": {
              "accessors": ["$sortedPopulateFeatures"],
              "annotations": [{ "count": 23, "index": 0, "kind": "idref" }],
              "code": "$sortedPopulateFeatures.features",
              "source": "$sortedPopulateFeatures.features"
            },
            "labelFieldName": {
              "accessors": ["$populateSearchField"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$populateSearchField.result.field",
              "source": "$populateSearchField.result.field"
            },
            "valueFieldName": {
              "accessors": ["$populateSearchField"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$populateSearchField.result.field",
              "source": "$populateSearchField.result.field"
            }
          },
          "name": "populateFeatureFormItems",
          "position": "240,1290",
          "title": "Get Form Element Items From Features",
          "transitions": [
            {
              "id": 377,
              "inputs": {},
              "position": "360,1420 360,1460",
              "target": { "id": 345 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 343,
          "inputs": {
            "expression": {
              "accessors": ["$searchFields", "$populateEventData"],
              "annotations": [
                { "count": 13, "index": 0, "kind": "idref" },
                { "count": 18, "index": 41, "kind": "idref" }
              ],
              "code": "$searchFields.result.find(function (x) { return x.field === $populateEventData.elementId; })",
              "source": "$searchFields.result.find(x=> x.field ===$populateEventData.elementId)"
            }
          },
          "name": "populateSearchField",
          "position": "-20,210",
          "title": "Evaluate Expression",
          "transitions": [
            {
              "id": 375,
              "inputs": {},
              "position": "100,280 100,330",
              "target": { "id": 333 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::SetFormElementItems",
          "description": "",
          "id": 345,
          "inputs": {
            "elementName": {
              "accessors": ["$populateEventData"],
              "annotations": [{ "count": 18, "index": 0, "kind": "idref" }],
              "code": "$populateEventData.elementId",
              "source": "$populateEventData.elementId"
            },
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            },
            "items": {
              "accessors": ["$populateFeatureFormItems"],
              "annotations": [{ "count": 25, "index": 0, "kind": "idref" }],
              "code": "$populateFeatureFormItems.items",
              "source": "$populateFeatureFormItems.items"
            }
          },
          "position": "240,1460",
          "title": "Set Form Element Items"
        },
        {
          "id": 347,
          "inputs": {},
          "position": "10,-190",
          "purpose": "start",
          "title": "Subworkflow",
          "transitions": [
            {
              "id": 379,
              "inputs": {},
              "position": "100,-130 100,-70",
              "sourceConnector": "bottom",
              "target": { "id": 349 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormEventData",
          "id": 349,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "name": "populateEventData",
          "position": "-20,-70",
          "title": "Get Form Event Data",
          "transitions": [
            {
              "id": 381,
              "inputs": {},
              "position": "100,0 100,50",
              "target": { "id": 351 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 351,
          "inputs": {
            "condition": {
              "accessors": ["$populateEvent"],
              "annotations": [{ "count": 14, "index": 2, "kind": "idref" }],
              "code": "!!$populateEvent.arguments",
              "source": "!!$populateEvent.arguments"
            }
          },
          "position": "40,50",
          "title": "If",
          "transitions": [
            {
              "branch": "false",
              "id": 383,
              "inputs": {},
              "position": "160,80 180,80 180,190 100,190 100,210",
              "sourceConnector": "right",
              "target": { "id": 343 },
              "targetConnector": "top"
            },
            {
              "branch": "true",
              "id": 385,
              "inputs": {},
              "position": "40,80 -110,80 -110,110",
              "sourceConnector": "left",
              "target": { "id": 353 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::SetProperty",
          "id": 353,
          "inputs": {
            "object": {
              "accessors": ["$populateEventData"],
              "annotations": [{ "count": 18, "index": 0, "kind": "idref" }],
              "code": "$populateEventData",
              "source": "$populateEventData "
            },
            "propertyName": "elementId",
            "propertyValue": {
              "accessors": ["$populateEvent"],
              "annotations": [{ "count": 14, "index": 0, "kind": "idref" }],
              "code": "$populateEvent.arguments.elementId",
              "source": "$populateEvent.arguments.elementId"
            }
          },
          "position": "-230,110",
          "title": "Set Property",
          "transitions": [
            {
              "id": 387,
              "inputs": {},
              "position": "-110,140 -110,190 100,190 100,210",
              "sourceConnector": "bottom",
              "target": { "id": 343 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormElementItemsFromCollection",
          "id": 355,
          "inputs": {
            "collection": {
              "accessors": ["$populateCodedValues"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$populateCodedValues.result",
              "source": "$populateCodedValues.result"
            },
            "labelFieldName": "name",
            "valueFieldName": "code"
          },
          "name": "populateCodedFormItems",
          "position": "-290,1300",
          "title": "Get Form Element Items From Collection",
          "transitions": [
            {
              "id": 391,
              "inputs": {},
              "position": "-170,1370 -170,1440",
              "target": { "id": 357 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::SetFormElementItems",
          "id": 357,
          "inputs": {
            "elementName": {
              "accessors": ["$populateEventData"],
              "annotations": [{ "count": 18, "index": 0, "kind": "idref" }],
              "code": "$populateEventData.elementId",
              "source": "$populateEventData.elementId"
            },
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            },
            "items": {
              "accessors": ["$populateCodedFormItems"],
              "annotations": [{ "count": 23, "index": 0, "kind": "idref" }],
              "code": "$populateCodedFormItems.items",
              "source": "$populateCodedFormItems.items"
            }
          },
          "position": "-290,1440",
          "title": "Set Form Element Items"
        }
      ]
    },
    {
      "id": 393,
      "steps": [
        {
          "action": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3::GenerateWhereClause",
          "id": 395,
          "inputs": {
            "layer": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result",
              "source": "$layer.result"
            },
            "queryFields": {
              "accessors": ["$searchFields"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$searchFields.result.searchFields",
              "source": "$searchFields.result.searchFields"
            },
            "targetForm": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm",
              "source": "$queryForm"
            }
          },
          "name": "finalWhereClause",
          "position": "-30,-130",
          "title": "Generate Where Clause",
          "transitions": [
            {
              "id": 415,
              "inputs": {},
              "position": "90,-60 90,-20",
              "sourceConnector": "bottom",
              "target": { "id": 397 }
            }
          ]
        },
        {
          "action": "gcx:wf:arcgis:query:QueryTask",
          "id": 397,
          "inputs": {
            "outFields": "*",
            "returnGeometry": true,
            "url": {
              "accessors": ["$layerUrl"],
              "annotations": [{ "count": 9, "index": 0, "kind": "idref" }],
              "code": "$layerUrl.result",
              "source": "$layerUrl.result"
            },
            "where": {
              "accessors": ["$finalWhereClause"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$finalWhereClause.result",
              "source": "$finalWhereClause.result"
            }
          },
          "name": "layerQuery",
          "position": "-30,-20",
          "title": "Query Layer",
          "transitions": [
            {
              "id": 417,
              "inputs": {},
              "position": "90,50 90,110",
              "sourceConnector": "bottom",
              "target": { "id": 399 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 399,
          "inputs": {
            "condition": {
              "accessors": ["$layerQuery"],
              "annotations": [{ "count": 11, "index": 0, "kind": "idref" }],
              "code": "$layerQuery.features.length > 0",
              "source": "$layerQuery.features.length > 0"
            }
          },
          "position": "30,110",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 419,
              "inputs": {},
              "position": "30,140 10,140 10,260 90,260 90,280",
              "sourceConnector": "left",
              "target": { "id": 401 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 421,
              "inputs": {},
              "position": "150,140 460,140 460,270",
              "sourceConnector": "right",
              "target": { "id": 403 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:app::RunOperation",
          "id": 401,
          "inputs": {
            "operationName": "results.from-graphics",
            "operationParameter": {
              "accessors": ["$layerQuery", "$layer", "$mapInfo"],
              "annotations": [
                { "count": 11, "index": 11, "kind": "idref" },
                { "count": 6, "index": 39, "kind": "idref" },
                { "count": 8, "index": 61, "kind": "idref" }
              ],
              "code": "{ graphics: $layerQuery.features, layer: $layer.result, maps: [$mapInfo.map.mapExtension] }",
              "source": "{graphics: $layerQuery.features, layer:$layer.result, maps: [$mapInfo.map.mapExtension]}"
            }
          },
          "name": "resultSet",
          "position": "-30,280",
          "title": "Get VertiGIS Features",
          "transitions": [
            {
              "id": 423,
              "inputs": {},
              "position": "90,350 90,400",
              "target": { "id": 405 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::SetProperty",
          "id": 403,
          "inputs": {
            "object": {
              "accessors": ["$noResults"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$noResults",
              "source": "$noResults"
            },
            "propertyName": "result",
            "propertyValue": true
          },
          "position": "340,270",
          "title": "Set noResults to true"
        },
        {
          "action": "gcx:wf:core::AddItems",
          "id": 405,
          "inputs": {
            "collection": {
              "accessors": ["$resultSet"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$resultSet.result",
              "source": "$resultSet.result"
            },
            "itemsToAdd": {
              "accessors": ["$resultSet"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$resultSet.result",
              "source": "$resultSet.result"
            }
          },
          "position": "-30,400",
          "title": "Add Items",
          "transitions": [
            {
              "id": 425,
              "inputs": {},
              "position": "90,430 90,480",
              "sourceConnector": "bottom",
              "target": { "id": 407 }
            }
          ]
        },
        {
          "action": "gcx:wf:app::RunCommand",
          "id": 407,
          "inputs": {
            "commandName": "map.go-to-geometry",
            "commandParameter": {
              "accessors": ["$resultSet"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$resultSet.result",
              "source": "$resultSet.result"
            }
          },
          "position": "-30,480",
          "title": "Zoom to Features",
          "transitions": [
            {
              "id": 427,
              "inputs": {},
              "position": "90,510 90,560",
              "target": { "id": 409 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::SetProperty",
          "id": 409,
          "inputs": {
            "object": {
              "accessors": ["$noResults"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$noResults",
              "source": "$noResults"
            },
            "propertyName": "result",
            "propertyValue": false
          },
          "position": "-30,560",
          "title": "Set noResults to false",
          "transitions": [
            {
              "id": 429,
              "inputs": {},
              "position": "90,590 90,630",
              "target": { "id": 411 }
            }
          ]
        },
        {
          "action": "gcx:wf:app::RunCommand",
          "id": 411,
          "inputs": {
            "commandName": "results.display",
            "commandParameter": {
              "accessors": ["$resultSet"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$resultSet.result",
              "source": "$resultSet.result"
            }
          },
          "position": "-30,630",
          "title": "Display results",
          "transitions": [
            {
              "id": 764,
              "inputs": {},
              "position": "90,660 90,710",
              "target": { "id": 763 }
            }
          ]
        },
        {
          "id": 413,
          "inputs": {},
          "position": "0,-240",
          "purpose": "start",
          "title": "Container",
          "transitions": [
            {
              "id": 431,
              "inputs": {},
              "position": "90,-180 90,-130",
              "target": { "id": 395 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::SetWorkflowOutput",
          "id": 763,
          "inputs": {
            "name": "queryResult",
            "value": {
              "accessors": ["$resultSet"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$resultSet.result",
              "source": "$resultSet.result"
            }
          },
          "position": "-30,710",
          "title": "Set Workflow Output"
        }
      ]
    },
    {
      "id": 433,
      "steps": [
        {
          "id": 435,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Subworkflow",
          "transitions": [
            {
              "id": 449,
              "inputs": {},
              "position": "90,60 90,150",
              "sourceConnector": "bottom",
              "target": { "id": 437 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormEventData",
          "id": 437,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "name": "validateEventData",
          "position": "-30,150",
          "title": "Get Form Event Data",
          "transitions": [
            {
              "id": 451,
              "inputs": {},
              "position": "90,220 90,270",
              "target": { "id": 439 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Log",
          "id": 439,
          "inputs": {
            "message": {
              "accessors": [],
              "code": "\"Validae Event\"",
              "source": "\"Validae Event\""
            }
          },
          "position": "-30,270",
          "title": "Log",
          "transitions": [
            {
              "id": 453,
              "inputs": {},
              "position": "90,300 90,350",
              "target": { "id": 441 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Log",
          "id": 441,
          "inputs": {
            "message": {
              "accessors": ["$validateEventData"],
              "annotations": [{ "count": 18, "index": 0, "kind": "idref" }],
              "code": "$validateEventData",
              "source": "$validateEventData"
            }
          },
          "position": "-30,350",
          "title": "Log",
          "transitions": [
            {
              "id": 457,
              "inputs": {},
              "position": "90,380 90,430",
              "target": { "id": 447 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::RunWorkflow",
          "id": 443,
          "inputs": {
            "arguments": {
              "accessors": ["$searchFields", "$changedEventData", "$queryForm"],
              "annotations": [
                { "count": 13, "index": 14, "kind": "idref" },
                { "count": 17, "index": 46, "kind": "idref" },
                { "count": 10, "index": 75, "kind": "idref" }
              ],
              "code": "{ searchFields: $searchFields.result, eventData: $changedEventData, formState: $queryForm.state, type: \"validate\" }",
              "source": "{searchFields:$searchFields.result, eventData:$changedEventData, formState:$queryForm.state, type: \"validate\"}"
            },
            "url": {
              "accessors": ["$eventSubWorkflow"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$eventSubWorkflow.result",
              "source": "$eventSubWorkflow.result"
            }
          },
          "name": "runValidateSubWorkflow",
          "position": "-210,600",
          "title": "Run Workflow",
          "transitions": [
            {
              "id": 455,
              "inputs": {},
              "position": "-90,670 -90,790 100,790 100,810",
              "sourceConnector": "bottom",
              "target": { "id": 445 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::PropagateFormEvent",
          "id": 445,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "position": "-20,810",
          "title": "Propagate Form Event"
        },
        {
          "action": "gcx:wf:core::If",
          "id": 447,
          "inputs": {
            "condition": {
              "accessors": ["$hasSubWorkflow"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$hasSubWorkflow.result",
              "source": "$hasSubWorkflow.result"
            }
          },
          "position": "30,430",
          "title": "If",
          "transitions": [
            {
              "branch": "false",
              "id": 459,
              "inputs": {},
              "position": "150,460 170,460 170,790 100,790 100,810",
              "sourceConnector": "right",
              "target": { "id": 445 },
              "targetConnector": "top"
            },
            {
              "branch": "true",
              "id": 461,
              "inputs": {},
              "position": "30,460 -90,460 -90,600",
              "sourceConnector": "left",
              "target": { "id": 443 },
              "targetConnector": "top"
            }
          ]
        }
      ]
    },
    {
      "id": 463,
      "steps": [
        {
          "id": 465,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Subworkflow",
          "transitions": [
            {
              "id": 479,
              "inputs": {},
              "position": "90,60 90,130",
              "sourceConnector": "bottom",
              "target": { "id": 467 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormEventData",
          "id": 467,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "name": "clickedEventData",
          "position": "-30,130",
          "title": "Get Form Event Data",
          "transitions": [
            {
              "id": 481,
              "inputs": {},
              "position": "90,200 90,250",
              "target": { "id": 469 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Log",
          "id": 469,
          "inputs": {
            "message": {
              "accessors": [],
              "code": "\"Clicked Event\"",
              "source": "\"Clicked Event\""
            }
          },
          "position": "-30,250",
          "title": "Log",
          "transitions": [
            {
              "id": 483,
              "inputs": {},
              "position": "90,280 90,330",
              "target": { "id": 471 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Log",
          "id": 471,
          "inputs": {
            "message": {
              "accessors": ["$clickedEventData"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$clickedEventData",
              "source": "$clickedEventData"
            }
          },
          "position": "-30,330",
          "title": "Log",
          "transitions": [
            {
              "id": 487,
              "inputs": {},
              "position": "90,360 90,410",
              "target": { "id": 477 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::RunWorkflow",
          "id": 473,
          "inputs": {
            "arguments": {
              "accessors": ["$searchFields", "$changedEventData", "$queryForm"],
              "annotations": [
                { "count": 13, "index": 14, "kind": "idref" },
                { "count": 17, "index": 46, "kind": "idref" },
                { "count": 10, "index": 75, "kind": "idref" }
              ],
              "code": "{ searchFields: $searchFields.result, eventData: $changedEventData, formState: $queryForm.state, type: \"clicked\" }",
              "source": "{searchFields:$searchFields.result, eventData:$changedEventData, formState:$queryForm.state, type: \"clicked\"}"
            },
            "url": {
              "accessors": ["$eventSubWorkflow"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$eventSubWorkflow.result",
              "source": "$eventSubWorkflow.result"
            }
          },
          "name": "runClickedSubWorkflow",
          "position": "-260,540",
          "title": "Run Workflow",
          "transitions": [
            {
              "id": 485,
              "inputs": {},
              "position": "-140,610 -140,770 100,770 100,790",
              "sourceConnector": "bottom",
              "target": { "id": 475 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::PropagateFormEvent",
          "id": 475,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "position": "-20,790",
          "title": "Propagate Form Event"
        },
        {
          "action": "gcx:wf:core::If",
          "id": 477,
          "inputs": {
            "condition": {
              "accessors": ["$hasSubWorkflow"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$hasSubWorkflow.result",
              "source": "$hasSubWorkflow.result"
            }
          },
          "position": "30,410",
          "title": "If",
          "transitions": [
            {
              "branch": "false",
              "id": 489,
              "inputs": {},
              "position": "150,440 170,440 170,770 100,770 100,790",
              "sourceConnector": "right",
              "target": { "id": 475 },
              "targetConnector": "top"
            },
            {
              "branch": "true",
              "id": 491,
              "inputs": {},
              "position": "30,440 -140,440 -140,540",
              "sourceConnector": "left",
              "target": { "id": 473 },
              "targetConnector": "top"
            }
          ]
        }
      ]
    },
    {
      "id": 493,
      "steps": [
        {
          "id": 495,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Subworkflow",
          "transitions": [
            {
              "id": 509,
              "inputs": {},
              "position": "90,60 90,110",
              "target": { "id": 497 }
            }
          ]
        },
        {
          "action": "gcx:wf:forms::GetFormEventData",
          "id": 497,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "name": "changedEventData",
          "position": "-30,110",
          "title": "Get Form Event Data",
          "transitions": [
            {
              "id": 511,
              "inputs": {},
              "position": "90,180 90,230",
              "target": { "id": 499 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Log",
          "id": 499,
          "inputs": {
            "message": {
              "accessors": [],
              "code": "\"Changed Event\"",
              "source": "\"Changed Event\""
            }
          },
          "position": "-30,230",
          "title": "Log",
          "transitions": [
            {
              "id": 513,
              "inputs": {},
              "position": "90,260 90,310",
              "target": { "id": 501 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Log",
          "id": 501,
          "inputs": {
            "message": {
              "accessors": ["$changedEventData"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$changedEventData",
              "source": "$changedEventData"
            }
          },
          "position": "-30,310",
          "title": "Log",
          "transitions": [
            {
              "id": 515,
              "inputs": {},
              "position": "90,340 90,390",
              "target": { "id": 503 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 503,
          "inputs": {
            "condition": {
              "accessors": ["$hasSubWorkflow"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$hasSubWorkflow.result",
              "source": "$hasSubWorkflow.result"
            }
          },
          "position": "30,390",
          "title": "If",
          "transitions": [
            {
              "branch": "false",
              "id": 517,
              "inputs": {},
              "position": "150,420 170,420 170,680 50,680 50,700",
              "sourceConnector": "right",
              "target": { "id": 505 },
              "targetConnector": "top"
            },
            {
              "branch": "true",
              "id": 519,
              "inputs": {},
              "position": "30,420 -90,420 -90,560",
              "sourceConnector": "left",
              "target": { "id": 507 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::PropagateFormEvent",
          "id": 505,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "position": "-70,700",
          "title": "Propagate Form Event"
        },
        {
          "action": "gcx:wf:core::RunWorkflow",
          "id": 507,
          "inputs": {
            "arguments": {
              "accessors": ["$searchFields", "$changedEventData", "$queryForm"],
              "annotations": [
                { "count": 13, "index": 14, "kind": "idref" },
                { "count": 17, "index": 46, "kind": "idref" },
                { "count": 10, "index": 75, "kind": "idref" }
              ],
              "code": "{ searchFields: $searchFields.result, eventData: $changedEventData, formState: $queryForm.state, type: \"changed\" }",
              "source": "{searchFields:$searchFields.result, eventData:$changedEventData, formState:$queryForm.state, type: \"changed\"}"
            },
            "url": {
              "accessors": ["$eventSubWorkflow"],
              "annotations": [{ "count": 17, "index": 0, "kind": "idref" }],
              "code": "$eventSubWorkflow.result",
              "source": "$eventSubWorkflow.result"
            }
          },
          "name": "runChangedSubWorkflow",
          "position": "-210,560",
          "title": "Run Workflow",
          "transitions": [
            {
              "id": 521,
              "inputs": {},
              "position": "-90,630 -90,680 50,680 50,700",
              "sourceConnector": "bottom",
              "target": { "id": 505 },
              "targetConnector": "top"
            }
          ]
        }
      ]
    },
    {
      "id": 523,
      "steps": [
        {
          "action": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3::AddQueryElements",
          "id": 525,
          "inputs": {
            "description": {
              "accessors": ["$formDescription"],
              "annotations": [{ "count": 16, "index": 0, "kind": "idref" }],
              "code": "$formDescription.result",
              "source": "$formDescription.result"
            },
            "form": {
              "accessors": ["$queryForm"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$queryForm",
              "source": "$queryForm"
            },
            "layer": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result",
              "source": "$layer.result"
            },
            "searchFields": {
              "accessors": ["$searchFields"],
              "annotations": [{ "count": 13, "index": 0, "kind": "idref" }],
              "code": "$searchFields.result",
              "source": "$searchFields.result"
            },
            "title": {
              "accessors": ["$formTitle"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$formTitle.result",
              "source": "$formTitle.result"
            }
          },
          "name": "addConfigurableQueryElements2",
          "position": "-30,110",
          "title": "Add Configurable Query Elements"
        },
        {
          "id": 527,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Event",
          "transitions": [
            {
              "id": 529,
              "inputs": {},
              "position": "90,60 90,110",
              "target": { "id": 525 }
            }
          ]
        }
      ],
      "title": "load-header"
    },
    {
      "id": 531,
      "steps": [
        {
          "id": 533,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Event",
          "transitions": [
            {
              "id": 541,
              "inputs": {},
              "position": "90,60 90,110",
              "target": { "id": 535 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 535,
          "inputs": {
            "condition": {
              "accessors": ["$noResults"],
              "annotations": [{ "count": 10, "index": 0, "kind": "idref" }],
              "code": "$noResults.result",
              "source": "$noResults.result"
            }
          },
          "position": "30,110",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 543,
              "inputs": {},
              "position": "30,140 -220,140 -220,250",
              "target": { "id": 537 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 545,
              "inputs": {},
              "position": "150,140 360,140 360,270",
              "sourceConnector": "right",
              "target": { "id": 539 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:forms::SetFormElementError",
          "id": 537,
          "inputs": {
            "error": {
              "accessors": ["getText"],
              "code": "getText(values.key)",
              "source": "@queryForm-error-no-results",
              "values": { "key": "@queryForm-error-no-results" }
            },
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "position": "-340,250",
          "title": "Set Form Element Error"
        },
        {
          "action": "gcx:wf:forms::ClearFormElementError",
          "id": 539,
          "inputs": {
            "form": {
              "accessors": ["$$form"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$$form",
              "source": "$$form"
            }
          },
          "position": "240,270",
          "title": "Clear Form Element Error"
        }
      ],
      "title": "load-footer"
    },
    {
      "id": 547,
      "steps": [
        {
          "action": "gcx:wf:core::If",
          "id": 549,
          "inputs": {
            "condition": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result.type === \"subtype-sublayer\"",
              "source": "$layer.result.type === \"subtype-sublayer\""
            }
          },
          "position": "30,810",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 571,
              "inputs": {},
              "position": "30,840 -190,840 -190,1060",
              "sourceConnector": "left",
              "target": { "id": 551 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 573,
              "inputs": {},
              "position": "150,840 220,840 220,1060",
              "sourceConnector": "right",
              "target": { "id": 553 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 551,
          "inputs": {
            "expression": {
              "accessors": ["$layerUrl", "$layer", "$layer"],
              "annotations": [
                { "count": 9, "index": 0, "kind": "idref" },
                { "count": 6, "index": 22, "kind": "idref" },
                { "count": 6, "index": 50, "kind": "idref" }
              ],
              "code": "$layerUrl.result = \"\".concat($layer.result.parent.url, \"/\").concat($layer.result.parent.layerId)",
              "source": "$layerUrl.result = `${$layer.result.parent.url}/${$layer.result.parent.layerId}`"
            }
          },
          "name": "subtypeCase",
          "position": "-310,1060",
          "title": "Evaluate Expression"
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 553,
          "inputs": {
            "expression": {
              "accessors": ["$layerUrl", "$layer", "$layer"],
              "annotations": [
                { "count": 9, "index": 0, "kind": "idref" },
                { "count": 6, "index": 22, "kind": "idref" },
                { "count": 6, "index": 43, "kind": "idref" }
              ],
              "code": "$layerUrl.result = \"\".concat($layer.result.url, \"/\").concat($layer.result.layerId)",
              "source": "$layerUrl.result = `${$layer.result.url}/${$layer.result.layerId}`"
            }
          },
          "name": "others",
          "position": "100,1060",
          "title": "Evaluate Expression"
        },
        {
          "id": 555,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Container",
          "transitions": [
            {
              "id": 575,
              "inputs": {},
              "position": "90,60 90,110",
              "target": { "id": 557 }
            }
          ]
        },
        {
          "action": "gcx:wf:arcgis::GetLayer",
          "id": 557,
          "inputs": {
            "layerId": {
              "accessors": ["$layerId"],
              "annotations": [{ "count": 8, "index": 0, "kind": "idref" }],
              "code": "$layerId.result",
              "source": "$layerId.result"
            }
          },
          "name": "targetLayer",
          "position": "-30,110",
          "title": "Get Layer",
          "transitions": [
            {
              "id": 577,
              "inputs": {},
              "position": "90,180 90,230",
              "target": { "id": 559 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 559,
          "inputs": {
            "condition": {
              "accessors": ["$targetLayer"],
              "annotations": [{ "count": 12, "index": 1, "kind": "idref" }],
              "code": "!$targetLayer.layer",
              "source": "!$targetLayer.layer"
            }
          },
          "position": "30,230",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 579,
              "inputs": {},
              "position": "30,260 -40,260 -40,340",
              "sourceConnector": "left",
              "target": { "id": 561 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 581,
              "inputs": {},
              "position": "150,260 220,260 220,340",
              "sourceConnector": "right",
              "target": { "id": 563 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "description": "If the layer isn't found then search the map by layer title and layer ID",
          "id": 561,
          "inputs": {
            "expression": {
              "accessors": [
                "$mapInfo",
                "$layerId",
                "$mapInfo",
                "$layerId",
                "$layerId"
              ],
              "annotations": [
                { "count": 8, "index": 27, "kind": "idref" },
                { "count": 8, "index": 75, "kind": "idref" },
                { "count": 8, "index": 138, "kind": "idref" },
                { "count": 8, "index": 277, "kind": "idref" },
                { "count": 8, "index": 379, "kind": "idref" }
              ],
              "code": "(function () {\n    var layer = $mapInfo.map.map.allLayers.find(function (x) { return x.title === $layerId.result; });\n    if (layer == undefined) {\n        for (var _i = 0, _a = $mapInfo.map.map.allLayers.items; _i < _a.length; _i++) {\n            var l = _a[_i];\n            if (l.type === \"subtype-group\") {\n                var found = l.sublayers.items.some(function (x) { return x.title === $layerId.result; });\n                if (found) {\n                    layer = l.sublayers.items.find(function (x) { return x.title === $layerId.result; });\n                    ;\n                }\n            }\n        }\n    }\n    return layer;\n})()",
              "source": "(function(){\n  var layer = $mapInfo.map.map.allLayers.find(x=> x.title === $layerId.result);\n  if(layer == undefined) {\n     for(var l of $mapInfo.map.map.allLayers.items) {\n        if(l.type === \"subtype-group\") {\n           var found = l.sublayers.items.some(x=> x.title === $layerId.result);\n           if(found) {\n              layer = l.sublayers.items.find(x=> x.title === $layerId.result);;\n           }\n\n\n        }\n      }\n  }\n\n  return layer;\n})()"
            }
          },
          "name": "findLayerFunction",
          "position": "-160,340",
          "title": "Find layer function",
          "transitions": [
            {
              "id": 583,
              "inputs": {},
              "position": "-40,470 -40,510",
              "target": { "id": 565 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::SetProperty",
          "id": 563,
          "inputs": {
            "object": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer",
              "source": "$layer"
            },
            "propertyName": "result",
            "propertyValue": {
              "accessors": ["$targetLayer"],
              "annotations": [{ "count": 12, "index": 0, "kind": "idref" }],
              "code": "$targetLayer.layer",
              "source": "$targetLayer.layer"
            }
          },
          "position": "100,340",
          "title": "Set Property",
          "transitions": [
            {
              "id": 585,
              "inputs": {},
              "position": "220,370 220,790 90,790 90,810",
              "sourceConnector": "bottom",
              "target": { "id": 549 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 565,
          "inputs": {
            "condition": {
              "accessors": ["$findLayerFunction"],
              "annotations": [{ "count": 18, "index": 2, "kind": "idref" }],
              "code": "!!$findLayerFunction.result",
              "source": "!!$findLayerFunction.result"
            }
          },
          "position": "-100,510",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 587,
              "inputs": {},
              "position": "-100,540 -190,540 -190,660",
              "sourceConnector": "left",
              "target": { "id": 567 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 589,
              "inputs": {},
              "position": "20,540 70,540 70,660",
              "sourceConnector": "right",
              "target": { "id": 569 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::SetProperty",
          "id": 567,
          "inputs": {
            "object": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer",
              "source": "$layer"
            },
            "propertyName": "result",
            "propertyValue": {
              "accessors": ["$findLayerFunction"],
              "annotations": [{ "count": 18, "index": 0, "kind": "idref" }],
              "code": "$findLayerFunction.result",
              "source": "$findLayerFunction.result"
            }
          },
          "position": "-310,660",
          "title": "Set Property",
          "transitions": [
            {
              "id": 591,
              "inputs": {},
              "position": "-190,690 -190,790 90,790 90,810",
              "sourceConnector": "bottom",
              "target": { "id": 549 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::Throw",
          "id": 569,
          "inputs": {
            "message": {
              "accessors": ["getText"],
              "code": "getText(values.key)",
              "source": "@exception-layer-not-found",
              "values": { "key": "@exception-layer-not-found" }
            }
          },
          "position": "-50,660",
          "title": "Throw"
        }
      ]
    },
    {
      "id": 593,
      "steps": [
        {
          "id": 595,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Subworkflow",
          "transitions": [
            {
              "id": 611,
              "inputs": {},
              "position": "90,60 90,110",
              "target": { "id": 597 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 597,
          "inputs": {
            "expression": {
              "accessors": ["$generateQueryFields"],
              "annotations": [{ "count": 20, "index": 0, "kind": "idref" }],
              "code": "$generateQueryFields.arguments[\"field\"]",
              "source": "$generateQueryFields.arguments[\"field\"]"
            }
          },
          "name": "targetField",
          "position": "-30,110",
          "title": "Create Value",
          "transitions": [
            {
              "id": 617,
              "inputs": {},
              "position": "90,180 90,230",
              "target": { "id": 605 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 599,
          "inputs": {
            "condition": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 2, "kind": "idref" }],
              "code": "!!$layer.result.subtypeField",
              "source": "!!$layer.result.subtypeField"
            }
          },
          "position": "30,350",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 613,
              "inputs": {},
              "position": "30,380 -130,380 -130,500",
              "sourceConnector": "left",
              "target": { "id": 601 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 615,
              "inputs": {},
              "position": "150,380 240,380 240,460",
              "sourceConnector": "right",
              "target": { "id": 603 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::AddItem",
          "id": 601,
          "inputs": {
            "collection": {
              "accessors": ["$fieldsArray"],
              "annotations": [{ "count": 12, "index": 0, "kind": "idref" }],
              "code": "$fieldsArray.result",
              "source": "$fieldsArray.result"
            },
            "item": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result.subtypeField",
              "source": "$layer.result.subtypeField"
            }
          },
          "position": "-250,500",
          "title": "Add Item",
          "transitions": [
            {
              "id": 621,
              "inputs": {},
              "position": "-130,530 -130,730 140,730 140,750",
              "sourceConnector": "bottom",
              "target": { "id": 607 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::If",
          "id": 603,
          "inputs": {
            "condition": {
              "accessors": ["$layer", "$layer"],
              "annotations": [
                { "count": 6, "index": 2, "kind": "idref" },
                { "count": 6, "index": 28, "kind": "idref" }
              ],
              "code": "!!$layer.result.parent && !!$layer.result.parent.subtypeField",
              "source": "!!$layer.result.parent && !!$layer.result.parent.subtypeField"
            }
          },
          "position": "180,460",
          "title": "If",
          "transitions": [
            {
              "branch": "true",
              "id": 623,
              "inputs": {},
              "position": "180,490 140,490 140,600",
              "sourceConnector": "left",
              "target": { "id": 609 },
              "targetConnector": "top"
            },
            {
              "branch": "false",
              "id": 625,
              "inputs": {},
              "position": "300,490 320,490 320,730 140,730 140,750",
              "sourceConnector": "right",
              "target": { "id": 607 },
              "targetConnector": "top"
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 605,
          "inputs": {
            "expression": {
              "accessors": ["$targetField"],
              "annotations": [{ "count": 12, "index": 1, "kind": "idref" }],
              "code": "[$targetField.result]",
              "source": "[$targetField.result]"
            }
          },
          "name": "fieldsArray",
          "position": "-30,230",
          "title": "Create Value",
          "transitions": [
            {
              "id": 619,
              "inputs": {},
              "position": "90,300 90,350",
              "sourceConnector": "bottom",
              "target": { "id": 599 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::Evaluate",
          "id": 607,
          "inputs": {
            "expression": {
              "accessors": ["$generateQueryFields", "$fieldsArray"],
              "annotations": [
                { "count": 20, "index": 0, "kind": "idref" },
                { "count": 12, "index": 40, "kind": "idref" }
              ],
              "code": "$generateQueryFields.setResult({ fields: $fieldsArray.result })",
              "source": "$generateQueryFields.setResult({fields: $fieldsArray.result})"
            }
          },
          "name": "setFieldsOutput",
          "position": "20,750",
          "title": "Evaluate Expression"
        },
        {
          "action": "gcx:wf:core::AddItem",
          "id": 609,
          "inputs": {
            "collection": {
              "accessors": ["$fieldsArray"],
              "annotations": [{ "count": 12, "index": 0, "kind": "idref" }],
              "code": "$fieldsArray.result",
              "source": "$fieldsArray.result"
            },
            "item": {
              "accessors": ["$layer"],
              "annotations": [{ "count": 6, "index": 0, "kind": "idref" }],
              "code": "$layer.result.parent.subtypeField",
              "source": "$layer.result.parent.subtypeField"
            }
          },
          "position": "20,600",
          "title": "Add Item",
          "transitions": [
            {
              "id": 627,
              "inputs": {},
              "position": "140,630 140,750",
              "sourceConnector": "bottom",
              "target": { "id": 607 },
              "targetConnector": "top"
            }
          ]
        }
      ]
    },
    {
      "id": 629,
      "steps": [
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 263,
          "inputs": {
            "expression": {
              "accessors": ["$workflowInputs"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$workflowInputs.inputs.layerId",
              "source": "$workflowInputs.inputs.layerId"
            }
          },
          "name": "layerId",
          "position": "880,220",
          "title": "Create Value"
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 267,
          "inputs": {
            "expression": {
              "accessors": ["$workflowInputs"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$workflowInputs.inputs.searchFields",
              "source": "$workflowInputs.inputs.searchFields"
            }
          },
          "name": "searchFields",
          "position": "-30,220",
          "title": "Create Value",
          "transitions": [
            {
              "id": 271,
              "position": "90,290 90,340",
              "sourceConnector": "bottom",
              "target": { "id": 643 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 631,
          "inputs": {
            "expression": {
              "accessors": [],
              "code": "false",
              "source": "false"
            }
          },
          "name": "noResults",
          "position": "290,220",
          "title": "Create Value",
          "transitions": [
            {
              "id": 675,
              "inputs": {},
              "position": "410,290 410,340",
              "target": { "id": 649 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 633,
          "inputs": {
            "expression": {
              "accessors": ["$workflowInputs"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$workflowInputs.inputs.formTitle",
              "source": "$workflowInputs.inputs.formTitle"
            }
          },
          "name": "formTitle",
          "position": "580,340",
          "title": "Create Value",
          "transitions": [
            {
              "id": 655,
              "inputs": {},
              "position": "700,410 700,430 860,430 860,135 880,135",
              "sourceConnector": "bottom",
              "target": { "id": 635 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 635,
          "inputs": {
            "expression": {
              "accessors": ["$workflowInputs"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$workflowInputs.inputs.formDescription",
              "source": "$workflowInputs.inputs.formDescription"
            }
          },
          "name": "formDescription",
          "position": "880,100",
          "title": "Create Value",
          "transitions": [
            {
              "id": 265,
              "position": "1000,170 1000,220",
              "target": { "id": 263 }
            }
          ]
        },
        {
          "id": 637,
          "inputs": {},
          "position": "0,0",
          "purpose": "start",
          "title": "Container",
          "transitions": [
            {
              "id": 657,
              "inputs": {},
              "position": "90,60 90,100",
              "sourceConnector": "bottom",
              "target": { "id": 639 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::GetWorkflowInputs",
          "id": 639,
          "inputs": {},
          "name": "workflowInputs",
          "position": "-30,100",
          "title": "Get Workflow Inputs",
          "transitions": [
            { "id": 269, "position": "90,170 90,220", "target": { "id": 267 } }
          ]
        },
        {
          "action": "gcx:wf:arcgis::GetMap",
          "id": 643,
          "inputs": {},
          "name": "mapInfo",
          "position": "-30,340",
          "title": "Get Map",
          "transitions": [
            {
              "id": 255,
              "position": "210,375 270,375 270,135 290,135",
              "target": { "id": 647 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 647,
          "inputs": {},
          "name": "layer",
          "position": "290,100",
          "title": "Create Value",
          "transitions": [
            {
              "id": 673,
              "inputs": {},
              "position": "410,170 410,220",
              "target": { "id": 631 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 649,
          "inputs": {
            "expression": {
              "accessors": ["$workflowInputs"],
              "annotations": [{ "count": 15, "index": 0, "kind": "idref" }],
              "code": "$workflowInputs.inputs.eventSubWorkflow",
              "source": "$workflowInputs.inputs.eventSubWorkflow"
            }
          },
          "name": "eventSubWorkflow",
          "position": "290,340",
          "title": "Create Value",
          "transitions": [
            {
              "id": 667,
              "inputs": {},
              "position": "530,375 560,375 560,135 580,135",
              "target": { "id": 651 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 651,
          "inputs": {
            "expression": {
              "accessors": ["$eventSubWorkflow"],
              "annotations": [{ "count": 17, "index": 2, "kind": "idref" }],
              "code": "!!$eventSubWorkflow.result",
              "source": "!!$eventSubWorkflow.result"
            }
          },
          "name": "hasSubWorkflow",
          "position": "580,100",
          "title": "Create Value",
          "transitions": [
            {
              "id": 669,
              "inputs": {},
              "position": "700,170 700,220",
              "target": { "id": 653 }
            }
          ]
        },
        {
          "action": "gcx:wf:core::CreateValue",
          "id": 653,
          "inputs": {},
          "name": "layerUrl",
          "position": "580,220",
          "title": "Create Value",
          "transitions": [
            {
              "id": 256,
              "position": "700,290 700,340",
              "target": { "id": 633 }
            }
          ]
        }
      ]
    }
  ],
  "deploymentConfig": { "supportedApps": { "VSW": true } },
  "designerVersion": "5.36.0+40",
  "forms": [
    {
      "defaults": {},
      "elements": {
        "footer": {
          "enabled": true,
          "items": {
            "0": {
              "default": true,
              "index": 0,
              "label": { "markdown": "@queryForm-buttons-submit" },
              "validates": true,
              "value": "submit"
            },
            "1": {
              "index": 1,
              "label": { "markdown": "@queryForm-buttons-cancel" },
              "validates": false,
              "value": "cancel"
            }
          },
          "section": "footer",
          "type": "ButtonBar",
          "visible": true
        },
        "header": {
          "section": "header",
          "title": { "markdown": "@queryForm-title" },
          "type": "Header"
        }
      },
      "id": 677
    }
  ],
  "licenseInfo": { "licenseeId": "88cb61d6-af47-9b3e-5181-ed674c4c0815" },
  "references": [
    {
      "id": 275,
      "path": "https://localhost:5000",
      "suite": "uuid:fc5de4bd-b399-4353-82ea-cbf393a350b3"
    }
  ],
  "start": { "id": 3 },
  "strings": {
    "de": {
      "exception-field-not-found": "Abfragefeld im Ziellayer nicht gefunden.  Bitte wenden Sie sich an den Anwendungsadministrator.",
      "exception-layer-not-found": "Ziellayer nicht in Webkarte gefunden. Bitte kontaktieren Sie den Systemadministrator",
      "queriesListForm-buttons-cancel": "Abbrechen",
      "queriesListForm-buttons-refine": "Abfrage ändern",
      "queriesListForm-buttons-run": "Abfragen",
      "queriesListForm-title": "Gespeichert Abfragen",
      "queryForm-buttons-back": "Zurück",
      "queryForm-buttons-cancel": "Abbrechen",
      "queryForm-buttons-submit": "Starten",
      "queryForm-error-no-results": "Die Abfrage hat keine Ergebnisse zurückgegeben. Bitte passen Sie die Parameter an und versuchen Sie es erneut.",
      "queryForm-queriesList-description": "Wählen Sie eine Abfrage auch der untenstehenden Liste aus.",
      "queryForm-queriesList-title": "Gespeicherte Abfragen",
      "queryForm-title": "Layerabfrage"
    },
    "inv": {
      "exception-field-not-found": "Query field not found in target layer.  Please contact the application administrator.",
      "exception-layer-not-found": "Target layer not found in web map. Please contact the system administrator",
      "queriesListForm-buttons-cancel": "Close",
      "queriesListForm-buttons-refine": "Refine Query",
      "queriesListForm-buttons-run": "Run Query",
      "queriesListForm-title": "Stored Queries",
      "queryForm-buttons-back": "Back",
      "queryForm-buttons-cancel": "Close",
      "queryForm-buttons-submit": "Submit",
      "queryForm-error-no-results": "The query return no results.  Please adjust the parameters and try again.",
      "queryForm-queriesList-description": "Select the query from the list below.",
      "queryForm-queriesList-title": "Stored Queries",
      "queryForm-title": "Layer Query"
    }
  },
  "transitions": [
    {
      "branch": "content",
      "id": 711,
      "inputs": {},
      "source": { "id": 679 },
      "target": { "id": 637 }
    },
    {
      "branch": "content",
      "id": 713,
      "inputs": {},
      "source": { "id": 681 },
      "target": { "id": 595 }
    },
    {
      "branch": "content",
      "id": 715,
      "inputs": {},
      "source": { "id": 683 },
      "target": { "id": 555 }
    },
    {
      "branch": "load$footer",
      "id": 717,
      "inputs": {},
      "source": { "id": 685 },
      "target": { "id": 533 }
    },
    {
      "branch": "load$header",
      "id": 719,
      "inputs": {},
      "source": { "id": 685 },
      "target": { "id": 527 }
    },
    {
      "branch": "content",
      "id": 721,
      "inputs": {},
      "source": { "id": 689 },
      "target": { "id": 495 }
    },
    {
      "branch": "content",
      "id": 723,
      "inputs": {},
      "source": { "id": 697 },
      "target": { "id": 465 }
    },
    {
      "branch": "content",
      "id": 725,
      "inputs": {},
      "source": { "id": 699 },
      "target": { "id": 435 }
    },
    {
      "branch": "content",
      "id": 727,
      "inputs": {},
      "source": { "id": 705 },
      "target": { "id": 413 }
    },
    {
      "branch": "content",
      "id": 729,
      "inputs": {},
      "source": { "id": 707 },
      "target": { "id": 347 }
    },
    {
      "branch": "content",
      "id": 731,
      "inputs": {},
      "source": { "id": 709 },
      "target": { "id": 290 }
    }
  ]
}
